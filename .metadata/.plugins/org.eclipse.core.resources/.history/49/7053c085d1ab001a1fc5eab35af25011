package kadai1;

import java.io.IOException;
import java.nio.charset.Charset;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardCopyOption;
import java.util.Objects;
import java.util.Scanner;

public class Kadai1 {

	public static void main(String[] args) throws Exception {
		Path fromPath = Path.of("/Users/sakaishow/bss/test.txt");
		Path editPath = Path.of("/Users/sakaishow/bss/edit.txt");
		Charset charset = Charset.forName("MS932");
		Scanner sc = new Scanner(System.in);
		
		try {
			// 元のファイルが存在するか確認
			while(true) {
				if(!Files.exists(fromPath)) {
					System.out.println(fromPath + "が存在しません。作成してください");
					System.out.println("作成したら1, キャンセルする場合は2を入力してください");
					String input = sc.nextLine();
					if(Objects.equals(input, "1")) {
						continue;
					}else if(Objects.equals(input, "2")){
						throw new Exception(fromPath + "ファイルが存在しません");
					}
				}
				
				System.out.println("aa");
				// 元のファイルに文字が存在するか確認
				String originText = Files.readString(fromPath, charset);
				if(originText.isEmpty()) {
					System.out.println(fromPath + "に文字を入力してください");
					System.out.println("入力したら1, キャンセルする場合は2を入力してください");
					throw new Exception(fromPath + "に文字が存在しません");
				}
				
				String replacedText = originText.replaceAll("12", "xy");
				Files.copy(fromPath, editPath, StandardCopyOption.REPLACE_EXISTING);
				Files.writeString(editPath, replacedText);
			}
		} catch(IOException e) {
			e.printStackTrace();
		} catch(Exception e) {
			e.printStackTrace();
		}
		
		System.out.println("処理が終了しました");
	}
}
